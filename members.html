<html ng-app="DOECaptainsApp">
	<head>
		<meta charset='utf-8'>
		<meta http-equiv='X-UA-Compatible' content='IE=edge'>
		<meta name='viewport' content='width=device-width, initial-scale=1'>
		<meta name='description' content='Lexington National Science Science Bowl Team Data Tracker'>
		<meta name='author' content='Clive Chan (http://clive.io)'>
		
		<title>DOE Captains Tracker -- Members</title>
		
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
		<script src="https://cdn.firebase.com/js/client/2.2.4/firebase.js"></script>
		<script src="https://cdn.firebase.com/libs/angularfire/1.1.2/angularfire.min.js"></script>
		<script src="new.js"></script>
		<link rel="stylesheet" href="style.css">
		<script>
		app.controller("Members", function($scope, $firebaseArray){
			$scope.predicate = 'name';
			$scope.direction = true;
			$scope.members = $firebaseArray(new Firebase(currFirebaseURL+"/members"));
			
			$scope.allowedGrades = [9,10,11,12];
			$scope.allowedSubjs = ["Bio","Chem","Phys","Math","ESS"];
		});
		</script>
	</head>
	<body ng-controller="List">
		<table ng-controller="Members" class="list-table">
			<thead>
				<tr>
					<th></th>
					<th><a href="" ng-click="order('name')" class="sortby" ng-class="{forward: predicate=='name' && direction, reverse: predicate=='name' && !direction}">Name</a></th>
					<th><a href="" ng-click="order('grade')" class="sortby" ng-class="{forward: predicate=='grade' && direction, reverse: predicate=='grade' && !direction}">Grade</a></th>
					<th></th>
				</tr>
				<tr>
					<th></th>
					<th><input ng-model="searchTerm" placeholder="filter or add..."></th>
					<th></th>
					<th><button class="yBtn" ng-disabled="!searchTerm" ng-click="addNew(members)">+</button></th>
				</tr>
			</thead>
			<tbody>
				<!--http://stackoverflow.com/a/18593018/1181387-->
				<tr ng-repeat="member in members | orderBy:predicate:!direction" ng-show="strInStr(searchTerm,member.name)">
					<td><input type="checkbox" name="member_selection" value="{{member.$id}}"></td>
					<td><input id="{{member.$id}}_name" ng-model="member.name" ng-change="members.$save(member)"></td>
					<td><select ng-model="member.grade" ng-change="members.$save(member)" ng-options="grade as grade for grade in allowedGrades"></select></td>
					<td><select ng-model="member.grade" ng-change="members.$save(member)" ng-options="subj as subj for subj in allowedSubjs"></select></td>
					<td><select ng-model="member.grade" ng-change="members.$save(member)" ng-options="subj as subj for subj in allowedSubjs"></select></td>
					<td><button class="xBtn" ng-click="remove(members,member)" tabindex="-1">x</button></td>
				</tr>
			</tbody>
		</table>
		<br>
		<br>
		<br>
		
		<datalist id="grades-list">
			<option ng-repeat="grade in grades">{{grade}}</option>
		</datalist>
		<datalist id="subjs-list">
			<option ng-repeat="subj in subjs">{{subj}}</option>
		</datalist>
	</body>
</html>
